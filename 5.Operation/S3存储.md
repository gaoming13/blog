## s3cmd - Amazon S3与其它使用S3协议的命令管理工具
> https://github.com/s3tools/s3cmd

```sh
# 安装s3cmd
yum install s3cmd
# 设置配置文件
s3cmd --configure
```

```
Access Key: 4TQ5CJGZS92LLEQHLXB3
Secret Key: enteryoursecretkeyhere
Default Region: US
S3 Endpoint: us-east-1.linodeobjects.com
DNS-style bucket+hostname:port template for accessing a bucket: us-east-1.linodeobjects.com
Encryption password: YOUR_GPG_KEY
Path to GPG program: /usr/local/bin/gpg
Use HTTPS protocol: False
HTTP Proxy server name:
HTTP Proxy server port: 0
```

### 常用命令

```sh
# 列出所有的bucket
s3cmd ls
```


## s3fs - 允许Linux和macOS通过fuse挂载s3存储桶

> https://github.com/s3fs-fuse/s3fs-fuse

### 安装s3fs

```sh
# 安装依赖包
yum install automake fuse fuse-devel gcc-c++ git libcurl-devel libxml2-devel make openssl-devel
# 编译并安装s3fs
git clone https://github.com/s3fs-fuse/s3fs-fuse.git
cd s3fs-fuse
./autogen.sh
./configure
make
sudo make install
# 设置密钥文件
echo AKIAIOEO4E2VOHLxxxxx:2LXBboddEpRLmWl48i3+b4ziwPL3bJ4vxxxxxxxx > ~/.passwd-s3fs
# 设置密钥文件只能够被当前用户访问
chmod 600 ~/.passwd-s3fs
```

### 手动挂载s3存储桶

```sh
# s3fs [BUCKET(S3存储桶名)] [MOUNTPOINT(本地目录名)] [-o <option_name>=<option_value>]...
# passwd_file=指定挂载的密钥文件
# url=访问s3的url
# endpoint=s3存储桶的endpoint
# allow_other=允许所有用户访问挂载点目录, /etc/fuse.conf 添加 user_allow_other
# connect_timeout=超时连接等待的时间,单位秒(默认300)
s3fs sam2020 /mnt/sam2020 \
  -o passwd_file=~/.passwd-s3fs \
  -o url=http://us-east-1.linodeobjects.com \
  -o endpoint=us-east-1 \
  -o allow_other
```

### 卸载s3存储桶

```sh
umount /mnt/sam2020
```

### 开机自动挂载s3存储桶

```sh
# 设置访问密钥文件的全局默认路径
echo AKIAIOEO4E2VOHLxxxxx:2LXBboddEpRLmWl48i3+b4ziwPL3bJ4vxxxxxxxx > /etc/passwd-s3fs
chmod 600 /etc/passwd-s3fs
# vi /etc/rc.local
s3fs sam2020 /mnt/sam2020 \
  -o passwd_file=/etc/passwd-s3fs \
  -o url=http://eu-central-1.linodeobjects.com \
  -o endpoint=eu-central-1 \
  -o allow_other
# 添加执行权限
chmod +x /etc/rc.local
```